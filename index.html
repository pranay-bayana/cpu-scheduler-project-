<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CPU Scheduler – Final Fixed (Frontend Only)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

<style>
/* ============= RESET ============= */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins',sans-serif;
}

/* ============= LOGIN PAGE ============= */
#loginPage{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#0d0d0d;
}

.login-box{
  width:360px;
  background:rgba(255,255,255,0.04);
  padding:40px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.1);
  backdrop-filter:blur(14px);
  box-shadow:0 0 25px rgba(0,212,255,0.15);
}

.login-box h2{
  text-align:center;
  margin-bottom:25px;
  color:#00eaff;
  font-weight:500;
}

.input-box{
  position:relative;
  margin-bottom:25px;
}

.input-box input{
  width:100%;
  padding:12px;
  background:transparent;
  border:none;
  border-bottom:2px solid rgba(255,255,255,0.3);
  color:#fff;
  outline:none;
}

.input-box label{
  position:absolute;
  left:10px;
  top:12px;
  color:#aaa;
  pointer-events:none;
  transition:0.3s;
}

.input-box input:focus,
.input-box input:valid{
  border-bottom-color:#00eaff;
}

.input-box input:focus+label,
.input-box input:valid+label{
  top:-8px;
  font-size:13px;
  color:#00eaff;
}

.login-btn{
  width:100%;
  padding:12px;
  background:#00eaff;
  border:none;
  border-radius:6px;
  font-size:17px;
  font-weight:600;
  cursor:pointer;
}

.login-btn:hover{
  box-shadow:0 0 12px rgba(0,212,255,0.6);
}

.error{
  display:none;
  margin-top:10px;
  text-align:center;
  color:#ff4d4d;
  font-size:14px;
}

/* ============= APP BASE ============= */

body.light{
  background:linear-gradient(135deg,#eef2ff,#f8fbff);
  color:#222;
}

body.dark-theme{
  background:radial-gradient(circle at top,#232746,#050814);
  color:#f5f5f5;
}

#appWrapper{
  display:none;
}

/* HEADER */
.header{
  height:60px;
  background:linear-gradient(135deg,#6d83f2,#8f63e4);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 22px;
  box-shadow:0 4px 15px rgba(0,0,0,0.15);
}

.header-left{
  display:flex;
  align-items:center;
  gap:8px;
}

.header-left .material-icons-outlined{
  font-size:26px;
}

.theme-toggle{
  width:36px;
  height:36px;
  border-radius:50%;
  border:none;
  background:rgba(255,255,255,0.25);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.theme-toggle .material-icons-outlined{
  font-size:22px;
  color:#fff;
}

/* BODY LAYOUT */
.app-body{
  display:flex;
  height:calc(100vh - 60px);
}

/* SIDEBAR */
.sidebar{
  width:240px;
  background:linear-gradient(180deg,#f3f5ff,#e8edff);
  padding-top:18px;
  box-shadow:2px 0 10px rgba(0,0,0,0.06);
}

.nav-item{
  padding:10px 18px;
  margin:6px 10px;
  border-radius:14px;
  display:flex;
  align-items:center;
  gap:10px;
  cursor:pointer;
  transition:0.25s;
  color:#333;
}
.nav-item .material-icons-outlined{
  font-size:20px;
}

.nav-item:hover{
  background:rgba(109,131,242,0.22);
  transform:translateX(4px);
}

.nav-item.active{
  background:linear-gradient(135deg,#6d83f2,#8f63e4);
  color:#fff;
  box-shadow:0 4px 12px rgba(109,131,242,0.6);
}

/* DARK SIDEBAR */
body.dark-theme .sidebar{
  background:linear-gradient(180deg,#17192f,#131528);
}
body.dark-theme .nav-item{
  color:#e0e2ff;
}
body.dark-theme .nav-item:hover{
  background:rgba(116,136,255,0.25);
}

/* MAIN AREA */
.main{
  flex:1;
  padding:24px 26px;
  overflow-y:auto;
}

.section{
  display:none;
}

.section.active{
  display:block;
  animation:fadeIn .28s;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(6px);}
  to{opacity:1; transform:translateY(0);}
}

/* CARDS */
.card-row{
  display:flex;
  flex-wrap:wrap;
  gap:18px;
}

.card{
  background:#fff;
  padding:20px;
  border-radius:18px;
  width:220px;
  box-shadow:0 4px 18px rgba(0,0,0,0.12);
  transition:0.25s;
}

.card:hover{
  transform:translateY(-3px);
  box-shadow:0 8px 25px rgba(109,131,242,0.3);
}

.card-title{
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:0.5px;
  color:#777;
}

.card-value{
  font-size:26px;
  margin-top:6px;
  font-weight:700;
}

/* DARK CARDS */
body.dark-theme .card{
  background:#15172c;
  border:1px solid rgba(130,145,255,0.4);
  box-shadow:0 8px 24px rgba(0,0,0,0.7);
}
body.dark-theme .card-title{
  color:#a4a9e7;
}
body.dark-theme .card-value{
  color:#f7f7ff;
}

/* FORM / INPUTS */
#add h2,#dash h2,#algo h2,#res h2{
  margin-bottom:10px;
}

#add label{
  margin-top:16px;
  margin-bottom:6px;
  font-weight:600;
  color:#333;
}
body.dark-theme #add label{
  color:#e3e5ff;
}

.form-control{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid #ccd2ef;
  background:#fff;
  margin-bottom:8px;
  transition:0.2s;
}

.form-control:focus{
  border-color:#6d83f2;
  box-shadow:0 0 10px rgba(109,131,242,0.25);
}

/* DARK INPUTS */
body.dark-theme .form-control{
  background:#0f1223;
  color:#f5f5ff;
  border:1px solid #40467f;
}

/* BUTTONS */
.btn{
  padding:10px 18px;
  border-radius:999px;
  border:none;
  background:linear-gradient(135deg,#6d83f2,#8f63e4);
  color:#fff;
  font-size:15px;
  cursor:pointer;
  transition:0.2s;
}
.btn:hover{
  box-shadow:0 6px 20px rgba(109,131,242,0.5);
  transform:translateY(-1px);
}
.btn-secondary{
  background:#e7ebfa;
  color:#333;
  margin-left:8px;
}
body.dark-theme .btn-secondary{
  background:#262a4d;
  color:#f5f5ff;
}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:8px;
  background:#fff;
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 4px 18px rgba(0,0,0,0.08);
}

th{
  padding:10px;
  background:linear-gradient(135deg,#6d83f2,#8f63e4);
  color:#fff;
  font-weight:500;
}

td{
  padding:10px;
  border-bottom:1px solid #eef1ff;
}

/* DARK TABLE */
body.dark-theme table{
  background:#101226;
  box-shadow:0 8px 24px rgba(0,0,0,0.7);
}
body.dark-theme th{
  background:linear-gradient(135deg,#3b458c,#5e6ad0);
}
body.dark-theme td{
  border-bottom:1px solid rgba(92,98,168,0.6);
  color:#f5f5ff;
}

/* GANTT CONTAINER */
.gantt-container{
  margin-top:14px;
  padding:16px;
  border-radius:20px;
  background:#11131f;
  display:flex;
  gap:10px;
  overflow-x:auto;
  box-shadow:0 6px 20px rgba(0,0,0,0.4);
}

/* GANTT BLOCKS */
.gantt-block{
  background:linear-gradient(135deg,#6d83f2,#8f63e4);
  padding:8px 12px;
  border-radius:14px;
  color:#fff;
  font-size:14px;
  font-weight:600;
  text-align:center;
  min-width:60px;
  box-shadow:0 4px 15px rgba(109,131,242,0.4);
  transition:0.2s;
}
.gantt-block:hover{
  transform:translateY(-2px) scale(1.02);
}
</style>
</head>

<body class="light">

<!-- ============= LOGIN PAGE ============= -->
<div id="loginPage">
  <div class="login-box">
    <h2>Login</h2>

    <div class="input-box">
      <input type="text" id="username" required>
      <label>Username</label>
    </div>

    <div class="input-box">
      <input type="password" id="password" required>
      <label>Password</label>
    </div>

    <button class="login-btn" onclick="validate()">Login</button>
    <div id="err" class="error"></div>
  </div>
</div>

<!-- ============= MAIN APP ============= -->
<div id="appWrapper">

  <div class="header">
    <div class="header-left">
      <span class="material-icons-outlined">speed</span>
      <h3>CPU Scheduler Dashboard</h3>
    </div>

    <div style="display:flex;align-items:center;gap:10px;">
      <div id="userInfo"></div>
      <button class="theme-toggle" onclick="toggleTheme()">
        <span id="themeIcon" class="material-icons-outlined">dark_mode</span>
      </button>
    </div>
  </div>

  <div class="app-body">
    <!-- SIDEBAR -->
    <div class="sidebar">
      <div class="nav-item active" onclick="openTab('dash',this)">
        <span class="material-icons-outlined">dashboard</span>
        <span>Dashboard</span>
      </div>
      <div class="nav-item" onclick="openTab('add',this)">
        <span class="material-icons-outlined">playlist_add</span>
        <span>Add Tasks</span>
      </div>
      <div class="nav-item" onclick="openTab('algo',this)">
        <span class="material-icons-outlined">settings_suggest</span>
        <span>Algorithm</span>
      </div>
      <div class="nav-item" onclick="openTab('res',this)">
        <span class="material-icons-outlined">bar_chart</span>
        <span>Results</span>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main">

      <!-- DASHBOARD TAB -->
      <div id="dash" class="section active">
        <h2>Dashboard</h2>
        <div class="card-row">
          <div class="card">
            <div class="card-title">Total Tasks</div>
            <div id="c_tasks" class="card-value">0</div>
          </div>
          <div class="card">
            <div class="card-title">Algorithm</div>
            <div id="c_algo" class="card-value">None</div>
          </div>
          <div class="card">
            <div class="card-title">Status</div>
            <div id="c_status" class="card-value">Not Run</div>
          </div>
        </div>
      </div>

      <!-- ADD TASKS TAB -->
      <div id="add" class="section">
        <h2>Add Task</h2>

        <label>Arrival Time</label>
        <input id="inA" class="form-control">

        <label>Burst Time</label>
        <input id="inB" class="form-control">

        <label>Priority</label>
        <input id="inP" class="form-control">

        <button class="btn" onclick="addTask()">Add</button>
        <button class="btn btn-secondary" onclick="clearTasks()">Clear</button>

        <table id="taskTable">
          <tr><th>ID</th><th>Arrival</th><th>Burst</th><th>Priority</th></tr>
        </table>
      </div>

      <!-- ALGORITHM TAB -->
      <div id="algo" class="section">
        <h2>Select Algorithm</h2>

        <select id="algoSelect" class="form-control">
          <option value="">Choose Algorithm</option>
          <option value="fcfs">FCFS</option>
          <option value="sjf">SJF</option>
          <option value="srtf">SRTF</option>
          <option value="rr">Round Robin</option>
          <option value="ee">Energy Efficient (EE)</option>
        </select>

        <div id="qBox" style="display:none;">
          <label>Quantum</label>
          <input id="quantum" class="form-control">
        </div>

        <button class="btn" style="margin-top:10px;" onclick="runSim()">Run Simulation</button>
      </div>

      <!-- RESULTS TAB -->
      <div id="res" class="section">
        <h2>Results</h2>

        <div class="card-row">
          <div class="card">
            <div class="card-title">Algorithm</div>
            <div id="r_algo" class="card-value"></div>
          </div>
          <div class="card">
            <div class="card-title">Avg Wait</div>
            <div id="r_wait" class="card-value"></div>
          </div>
          <div class="card">
            <div class="card-title">Avg Turnaround</div>
            <div id="r_turn" class="card-value"></div>
          </div>
        </div>

        <h3 style="margin-top:16px;">Per-Process Times</h3>
        <table id="resTable">
          <tr>
            <th>PID</th>
            <th>Arrival</th>
            <th>Burst</th>
            <th>Completion</th>
            <th>Waiting</th>
            <th>Turnaround</th>
          </tr>
        </table>

        <h3 style="margin-top:16px;">Gantt Chart</h3>
        <div class="gantt-container" id="gantt"></div>
      </div>

    </div>
  </div>
</div>

<script>
/* ---------- LOGIN ---------- */
function validate(){
  const u = document.getElementById("username").value.trim();
  const p = document.getElementById("password").value.trim();
  const err = document.getElementById("err");

  const strong = /^(?=.*[0-9])(?=.*[!@#$%^&*]).{6,}$/;

  if(!u || !p){
    err.style.display="block";
    err.textContent="Username & Password required";
    return;
  }
  if(!strong.test(p)){
    err.style.display="block";
    err.textContent="Password must contain number, special char & 6+ chars";
    return;
  }

  err.style.display="block";
  err.style.color="#00eaff";
  err.textContent="Strong Password ✔ Logging in...";

  setTimeout(()=>{
    document.getElementById("loginPage").style.display="none";
    document.getElementById("appWrapper").style.display="block";
    document.getElementById("userInfo").textContent="User: "+u;
  },800);
}

/* ---------- THEME TOGGLE ---------- */
function toggleTheme(){
  const body = document.body;
  const icon = document.getElementById("themeIcon");

  if(body.classList.contains("dark-theme")){
    body.classList.remove("dark-theme");
    icon.textContent="dark_mode";
  }else{
    body.classList.add("dark-theme");
    icon.textContent="light_mode";
  }
}

/* ---------- NAVIGATION ---------- */
function openTab(id, el){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');

  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  el.classList.add('active');
}

/* ---------- TASK DATA ---------- */
let tasks = [];
let tid = 1;

function addTask(){
  const aStr = document.getElementById("inA").value;
  const bStr = document.getElementById("inB").value;
  const pVal = document.getElementById("inP").value || "-";

  if(aStr==="" || bStr===""){
    alert("Enter Arrival & Burst Time");
    return;
  }

  const a = Number(aStr);
  const b = Number(bStr);

  if(isNaN(a) || isNaN(b) || a < 0 || b <= 0){
    alert("Enter valid numeric values (arrival ≥ 0, burst > 0)");
    return;
  }

  tasks.push({id:tid, arrival:a, burst:b, remaining:b, priority:pVal});
  tid++;

  updateTable();
  document.getElementById("c_tasks").textContent = tasks.length;

  // clear inputs
  document.getElementById("inA").value = "";
  document.getElementById("inB").value = "";
  document.getElementById("inP").value = "";
}

function updateTable(){
  const table = document.getElementById("taskTable");
  table.innerHTML = "<tr><th>ID</th><th>Arrival</th><th>Burst</th><th>Priority</th></tr>";
  tasks.forEach(t=>{
    table.innerHTML += `<tr>
      <td>${t.id}</td>
      <td>${t.arrival}</td>
      <td>${t.burst}</td>
      <td>${t.priority}</td>
    </tr>`;
  });
}

function clearTasks(){
  tasks = [];
  tid = 1;
  updateTable();
  document.getElementById("c_tasks").textContent = 0;
}

/* ---------- ALGO SELECT ---------- */
document.getElementById("algoSelect").addEventListener("change",()=>{
  const v = document.getElementById("algoSelect").value;
  document.getElementById("qBox").style.display = (v==="rr") ? "block" : "none";
});

/* ---------- HELPER: CLONE TASKS ---------- */
function cloneTasks(){
  return tasks.map(t => ({
    id: t.id,
    arrival: t.arrival,
    burst: t.burst,
    remaining: t.burst,
    priority: t.priority
  }));
}

/* ---------- SCHEDULERS ---------- */

function scheduleFCFS(list){
  list.sort((a,b)=>a.arrival - b.arrival);
  let t = 0;
  const gantt = [];

  for(const p of list){
    if(t < p.arrival) t = p.arrival;
    const start = t;
    const end = t + p.burst;
    gantt.push({id:p.id,start,end});
    t = end;
  }

  return {gantt, extra:{}};
}

function scheduleSJF(list){
  let t = 0;
  const n = list.length;
  let completed = 0;
  const gantt = [];

  list.sort((a,b)=>a.arrival - b.arrival);

  t = list[0]?.arrival ?? 0;

  while(completed < n){
    const available = list.filter(p => p.remaining > 0 && p.arrival <= t);
    if(available.length === 0){
      const next = list.find(p => p.remaining > 0);
      if(!next) break;
      t = next.arrival;
      continue;
    }

    available.sort((a,b)=>a.burst - b.burst);
    const cur = available[0];
    if(t < cur.arrival) t = cur.arrival;

    const start = t;
    const end = t + cur.remaining;
    gantt.push({id:cur.id,start,end});

    t = end;
    cur.remaining = 0;
    completed++;
  }

  return {gantt, extra:{}};
}

function scheduleSRTF(list){
  list.sort((a,b)=>a.arrival - b.arrival);
  let t = 0;
  const n = list.length;
  const gantt = [];
  let i = 0;
  let done = 0;
  const ready = [];

  if(n>0) t = list[0].arrival;

  while(done < n){
    while(i<n && list[i].arrival <= t){
      ready.push(list[i]);
      i++;
    }

    if(ready.length === 0){
      if(i < n){
        t = list[i].arrival;
        continue;
      } else break;
    }

    ready.sort((a,b)=>a.remaining - b.remaining);
    const cur = ready[0];

    const start = t;
    const end = t + 1;
    gantt.push({id:cur.id,start,end});

    cur.remaining -= 1;
    t = end;

    if(cur.remaining === 0){
      ready.shift();
      done++;
    }
  }

  return {gantt, extra:{}};
}

function scheduleRR(list, q){
  list.sort((a,b)=>a.arrival - b.arrival);
  const gantt = [];
  const n = list.length;
  let t = 0;
  let i = 0;
  const ready = [];

  if(n>0) t = list[0].arrival;

  while(true){
    while(i<n && list[i].arrival <= t){
      ready.push(list[i]);
      i++;
    }

    if(ready.length === 0){
      if(i<n){
        t = list[i].arrival;
        continue;
      } else break;
    }

    const cur = ready.shift();
    const run = Math.min(q, cur.remaining);
    const start = t;
    const end = t + run;
    gantt.push({id:cur.id,start,end});
    cur.remaining -= run;
    t = end;

    while(i<n && list[i].arrival <= t){
      ready.push(list[i]);
      i++;
    }

    if(cur.remaining > 0){
      ready.push(cur);
    }
  }

  return {gantt, extra:{}};
}

/* ---------- ENERGY-EFFICIENT (EE) SCHEDULER ---------- */
/*
  Idea:
  - Classify tasks based on burst:
      burst <= avgBurst  -> interactive (short)
      burst >  avgBurst  -> background (long)
  - Interactive: run with small slice (1 unit)
  - Background: run with bigger slice (2 units)
  - Simple energy model:
      energy += duration * weight
      weight = 1.2 for interactive, 0.8 for background
*/
function scheduleEE(list){
  list.sort((a,b)=>a.arrival - b.arrival);
  const n = list.length;
  const gantt = [];

  if(n === 0) return {gantt:[], extra:{energy:0}};

  const avgBurst = list.reduce((sum,p)=>sum+p.burst,0) / n;

  let t = list[0].arrival;
  let i = 0;
  const readyInt = [];
  const readyBg  = [];
  let energy = 0;

  // give each process a "type" based on burst
  list.forEach(p=>{
    p.type = (p.burst <= avgBurst) ? "interactive" : "background";
  });

  while(true){
    while(i<n && list[i].arrival <= t){
      if(list[i].type === "interactive") readyInt.push(list[i]);
      else readyBg.push(list[i]);
      i++;
    }

    if(readyInt.length === 0 && readyBg.length === 0){
      if(i < n){
        t = list[i].arrival;
        continue;
      }else break;
    }

    let cur;
    let slice;
    let weight;

    if(readyInt.length > 0){
      readyInt.sort((a,b)=>a.remaining - b.remaining);
      cur = readyInt[0];
      slice = 1;
      weight = 1.2;
    }else{
      readyBg.sort((a,b)=>a.remaining - b.remaining);
      cur = readyBg[0];
      slice = 2;
      weight = 0.8;
    }

    const run = Math.min(slice, cur.remaining);
    const start = t;
    const end   = t + run;
    gantt.push({id:cur.id,start,end});
    cur.remaining -= run;
    t = end;

    energy += run * weight;

    while(i<n && list[i].arrival <= t){
      if(list[i].type === "interactive") readyInt.push(list[i]);
      else readyBg.push(list[i]);
      i++;
    }

    if(cur.remaining === 0){
      if(cur.type === "interactive"){
        const idx = readyInt.indexOf(cur);
        if(idx !== -1) readyInt.splice(idx,1);
      }else{
        const idx = readyBg.indexOf(cur);
        if(idx !== -1) readyBg.splice(idx,1);
      }
    }
  }

  return {gantt, extra:{energy}};
}

/* ---------- METRICS & RENDERING ---------- */

function computeResults(list, gantt){
  const results = [];

  for(const p of list){
    let comp = 0;
    for(const g of gantt){
      if(g.id === p.id && g.end > comp){
        comp = g.end;
      }
    }
    const tat = comp - p.arrival;
    const wt  = tat - p.burst;

    results.push({
      id: p.id,
      arrival: p.arrival,
      burst: p.burst,
      completion: comp,
      waiting: wt,
      turnaround: tat
    });
  }

  let sw = 0, st = 0;
  results.forEach(r=>{
    sw += r.waiting;
    st += r.turnaround;
  });

  const avg_wait = results.length ? (sw / results.length) : 0;
  const avg_turn = results.length ? (st / results.length) : 0;

  return {results, avg_wait, avg_turn};
}

function renderResults(algo, resultsData, gantt, energyExtra){
  const {results, avg_wait, avg_turn} = resultsData;

  document.getElementById("r_algo").textContent = algo.toUpperCase();
  document.getElementById("r_wait").textContent = avg_wait.toFixed(2);
  document.getElementById("r_turn").textContent = avg_turn.toFixed(2);

  // Per-process table
  let rows = `<tr>
    <th>PID</th><th>Arrival</th><th>Burst</th>
    <th>Completion</th><th>Waiting</th><th>Turnaround</th>
  </tr>`;

  results.forEach(r=>{
    rows += `<tr>
      <td>T${r.id}</td>
      <td>${r.arrival}</td>
      <td>${r.burst}</td>
      <td>${r.completion}</td>
      <td>${r.waiting}</td>
      <td>${r.turnaround}</td>
    </tr>`;
  });

  document.getElementById("resTable").innerHTML = rows;

  // Gantt
  const gDiv = document.getElementById("gantt");
  gDiv.innerHTML = "";

  gantt.forEach(g=>{
    const box = document.createElement("div");
    box.className = "gantt-block";
    const width = (g.end - g.start) * 40;
    box.style.minWidth = width + "px";
    box.innerHTML = `
      <div>T${g.id}</div>
      <div style="font-size:12px;opacity:0.9;">${g.start} → ${g.end}</div>
    `;
    gDiv.appendChild(box);
  });

  // Dashboard updates
  document.getElementById("c_algo").textContent = algo.toUpperCase();
  let statusText = "Completed";
  if(algo === "ee" && energyExtra && typeof energyExtra.energy !== "undefined"){
    statusText = `Completed (Energy ≈ ${energyExtra.energy.toFixed(2)})`;
  }
  document.getElementById("c_status").textContent = statusText;

  // Auto switch to Results tab
  openTab("res", document.querySelectorAll(".nav-item")[3]);
}

/* ---------- RUN SIMULATION (FRONTEND ONLY) ---------- */
function runSim(){
  if(tasks.length === 0){
    alert("Add tasks first");
    return;
  }

  const algo = document.getElementById("algoSelect").value;
  if(!algo){
    alert("Choose an algorithm");
    return;
  }

  const clone = cloneTasks();
  let ganttInfo;

  if(algo === "fcfs"){
    ganttInfo = scheduleFCFS(clone);
  }
  else if(algo === "sjf"){
    ganttInfo = scheduleSJF(clone);
  }
  else if(algo === "srtf"){
    ganttInfo = scheduleSRTF(clone);
  }
  else if(algo === "rr"){
    const qVal = Number(document.getElementById("quantum").value);
    if(!qVal || qVal <= 0){
      alert("Enter valid quantum for Round Robin");
      return;
    }
    ganttInfo = scheduleRR(clone, qVal);
  }
  else if(algo === "ee"){
    ganttInfo = scheduleEE(clone);
  }else{
    alert("Unknown algorithm");
    return;
  }

  const resultsData = computeResults(clone, ganttInfo.gantt);
  renderResults(algo, resultsData, ganttInfo.gantt, ganttInfo.extra || {});
}
</script>

</body>
</html>